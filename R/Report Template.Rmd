---
title: "Dawson Break-Up Report `r lubridate::year(Sys.Date())`"
subtitle: " <br><br>"
date: "Prepared on `r Sys.Date()`"
output: 
  word_document:
      reference_docx: style_template.docx
      toc: true
      toc_depth: 3
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
This report is generated by Yukon Government based on data pulled from the [Real-Time Hydrometric Data](https://wateroffice.ec.gc.ca/mainmenu/real_time_data_index_e.html) published by the Government of Canada. This report is based on data downloaded at `r .POSIXct(Sys.time(), tz="America/Whitehorse")` Yukon time.

\newpage

# Current Status and Observations

[Enter update here]

\newpage



# Station data

Water level data is listed below in order of historical relative importance to flooding.

In the future, the order of listing could depend instead on which stations is highest in relation to historical levels.

```{r plot and explain data, echo=FALSE, message=FALSE, warning=FALSE, fig.width=6.5}
for (i in stations){
  #gather data using hydrometric_level.R
  station <- tidyhydat::hy_stations(i)
  levelData <- level_data(
  station_number = i,
  extract_realtime = TRUE, 
  select_years = lubridate::year(Sys.Date()), 
  )
  startYear <- min(lubridate::year(levelData[[1]]$Date), na.rm = T)
  
  #Summarize changes in the last day
  todayFlow <- levelData[[3]]$Value[levelData[[3]]$Date==Sys.Date()]
  todayPerc <- round(levelData[[3]]$prctile[levelData[[3]]$Date==Sys.Date()],2)
  yesterFlow <- levelData[[3]]$Value[levelData[[3]]$Date==(Sys.Date()-1)]
  
  #Communicate the change
  cat("  \n The current level is ", round(todayFlow,1), " which corresponds to the", todayPerc, " percentile of historic levels for this station.  Since yesterday, the level has ", ifelse(todayFlow<yesterFlow, "decreased", "increased"), " by ", round(abs(todayFlow-yesterFlow), 1))`. 

  #plot the data
  levelPlot <- level_plot(
    station_number = params$station_number,
    complete_year = levelData[[2]],
  	plot_years_df = levelData[[3]],
  	dummy_year_df = levelData[[4]],
    png_path = params$png_path
  )
  levelPlot
  

  cat("  \n This station is located in" , station$PROV_TERR_STATE_LOC, " at coordinates: ", station$LONGITUDE, station$LATITUDE, ".  Data collection began in ", startYear, "and the historic data are ", percent(sum(complete.cases(levelData[[1]]))/nrow(levelData[[1]])), " complete".)
}
```

## Yukon River at Dawson



```{r echo = FALSE, fig.cap = "Yukon River at Dawson: Level"}
plot(pressure)
```

## Klondike River at Bonanza Creek

## Klondike River at Rock Creek

## North Klondike River

## Yukon River Above White River

## White River Above Yukon River

## Stewar River Above Yukon River

## Indian River

## 60 Mile River

## Little South Klondike River

# Dawson Weather Forecast

# Still images

## White River at Yukon River (automated)
## SS Keno (Dawson, automated) 

## Other images
